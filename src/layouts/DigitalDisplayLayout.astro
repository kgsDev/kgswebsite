---
// src/layouts/DigitalDisplayLayout.astro
// Simple layout for digital directory display with watermark notice option
import '../styles/global.css';
import SimpleHeader from '../components/digital/SimpleHeader.astro';
import SimpleFooter from '../components/digital/SimpleFooter.astro';

export interface Props {
  title: string;
  headerTitle?: string;
  description?: string;
  noticeStyle?: 'banner' | 'watermark' | 'both';
  qrCodeUrl?: string;
  qrCodeLabel?: string;
  bannerText?: string;
  watermarkText?: string;
  watermarkSubtext?: string;
}

const { 
  title = 'Digital Directory',
  headerTitle = 'KGS Staff and Affiliates Directory',
  description = 'Kentucky Geological Survey digital display.',
  noticeStyle = 'banner', // Options: 'banner', 'watermark', 'both'
  qrCodeUrl = '/assets/qr-staff-directory.png',
  qrCodeLabel = 'Digital Display Only<br>Scan for Interactive Directory',
  bannerText = 'Display Only Screen â€¢ Scan QR Code for Interactive Directory',
  watermarkText = 'DISPLAY ONLY',
  watermarkSubtext = 'Scan QR Code for Interactive Directory'
} = Astro.props;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{title} - Kentucky Geological Survey</title>
    
    <!-- Import fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <slot name="head" />
  </head>
  <body class="min-h-screen flex flex-col bg-gray-50">
    <!-- Simple Header with dynamic title -->
    <SimpleHeader title={headerTitle} />
    
    <!-- Main Content -->
    <main class="flex-grow">
      <slot />
    </main>
    
    <!-- Watermark Notice (diagonal, semi-transparent) -->
    {(noticeStyle === 'watermark' || noticeStyle === 'both') && (
      <div class="watermark-notice">
        <div class="watermark-content">
          <div class="watermark-line">{watermarkText}</div>
          <div class="watermark-subline">{watermarkSubtext}</div>
        </div>
      </div>
    )}
    
    <!-- Banner Notice (top center) -->
    {bannerText && (noticeStyle === 'banner' || noticeStyle === 'both') && (
      <div class="display-notice">
        <svg xmlns="http://www.w3.org/2000/svg" class="notice-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span class="notice-text">{bannerText}</span>
      </div>
    )}

    <!-- Floating QR Code - Bottom Right -->
    <div class="floating-qr-code">
      <div class="qr-content">
        <img 
          src={qrCodeUrl}
          alt="QR Code"
          class="qr-image"
          onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'"
        />
        <div class="qr-fallback hidden">
          <img src="/assets/kgs-staffqr.png" alt="KGS QR Code" class="fallback-image" />
        </div>
        <p class="qr-label" set:html={qrCodeLabel}></p>
      </div>
    </div>
    
    <!-- Simple Footer -->
    <SimpleFooter />
  </body>
</html>

<style>
  /* Digital display optimizations */
  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    overflow-x: hidden;
  }
  
  /* Ensure content is always visible */
  main {
    min-height: calc(100vh - 200px);
  }
  
  /* Watermark Notice - Diagonal, semi-transparent overlay */
  .watermark-notice {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 998;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .watermark-content {
    transform: rotate(-45deg);
    opacity: 0.08;
    user-select: none;
  }
  
  .watermark-line {
    font-size: 6rem;
    font-weight: 900;
    color: #1e3a8a;
    text-align: center;
    line-height: 1;
    letter-spacing: 0.1em;
    white-space: nowrap;
  }
  
  .watermark-subline {
    font-size: 2rem;
    font-weight: 600;
    color: #1e3a8a;
    text-align: center;
    margin-top: 1rem;
    letter-spacing: 0.05em;
  }
  
  /* Display Notice Banner */
  .display-notice {
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(59, 130, 246, 0.95);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 9999px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    z-index: 999;
    font-size: 0.875rem;
    font-weight: 500;
  }
  
  .notice-icon {
    width: 1.25rem;
    height: 1.25rem;
    flex-shrink: 0;
  }
  
  .notice-text {
    white-space: nowrap;
  }
  
  /* Floating QR Code Styles */
  .floating-qr-code {
    position: fixed;
    bottom: 100px;
    right: 2rem;
    z-index: 1000;
    background: white;
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border: 2px solid #e5e7eb;
  }
  
  .qr-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
  }
  
  .qr-image {
    width: 180px;
    height: 180px;
    object-fit: contain;
    border-radius: 8px;
  }
  
  .qr-fallback {
    width: 180px;
    height: 180px;
    display: none;
    align-items: center;
    justify-content: center;
    background: #f3f4f6;
    border-radius: 8px;
  }
  
  .fallback-image {
    width: 160px;
    height: 160px;
    object-fit: contain;
  }
  
  .qr-label {
    font-size: 0.875rem;
    font-weight: 600;
    color: #1f2937;
    text-align: center;
    margin: 0;
  }
  
  /* Optimize for large displays */
  @media (min-width: 1920px) {
    html {
      font-size: 18px;
    }
    
    .watermark-line {
      font-size: 8rem;
    }
    
    .watermark-subline {
      font-size: 2.5rem;
    }
    
    .display-notice {
      top: 120px;
      padding: 1rem 2rem;
      font-size: 1rem;
    }
    
    .notice-icon {
      width: 1.5rem;
      height: 1.5rem;
    }
    
    .floating-qr-code {
      bottom: 120px;
      right: 3rem;
      padding: 1.5rem;
    }
    
    .qr-image {
      width: 220px;
      height: 220px;
    }
    
    .qr-fallback {
      width: 220px;
      height: 220px;
    }
    
    .fallback-image {
      width: 200px;
      height: 200px;
    }
    
    .qr-label {
      font-size: 1rem;
    }
  }
  
  /* Extra large displays */
  @media (min-width: 2560px) {
    .watermark-line {
      font-size: 10rem;
    }
    
    .watermark-subline {
      font-size: 3rem;
    }
    
    .floating-qr-code {
      bottom: 140px;
      right: 4rem;
      padding: 2rem;
    }
    
    .qr-image {
      width: 260px;
      height: 260px;
    }
    
    .qr-fallback {
      width: 260px;
      height: 260px;
    }
    
    .fallback-image {
      width: 240px;
      height: 240px;
    }
    
    .qr-label {
      font-size: 1.125rem;
    }
  }
  
  /* Prevent text selection for display purposes */
  .digital-display {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  
  /* Hide scrollbars for cleaner display look */
  .digital-display::-webkit-scrollbar {
    display: none;
  }
  
  .digital-display {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .hidden {
    display: none;
  }
</style>