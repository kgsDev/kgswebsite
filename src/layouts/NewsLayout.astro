---
// src/layouts/NewsLayout.astro
import BaseLayout from './BaseLayout.astro';
import { fetchNewsYears } from '../lib/api_news';

// Get list of available years for archive links
const years = await fetchNewsYears();

// Get current path for active link highlighting
const pathname = Astro.url.pathname;

// Define props with defaults specific to news pages
const { 
  title = 'News & Events',
  description = 'Latest news, updates, and events from the Kentucky Geological Survey.',
  showBreadcrumb = true,
} = Astro.props;
---

<BaseLayout 
  title={title}
  description={description}
  activePage="news"
  showBreadcrumb={showBreadcrumb}
>
  <!-- Pass breadcrumb content if needed -->
  <Fragment slot="breadcrumb">
    <span class="mx-2">â€º</span>
    <a href="/news" class="hover:text-[#0033A0] transition">News & Events</a>
    <slot name="breadcrumb" />
  </Fragment>
  
  <!-- Pass head content if needed -->
  <Fragment slot="head">
    <slot name="head-meta" />
  </Fragment>
  
  <!-- Main news content -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Sidebar for news categories, archives, etc. -->
    <aside class="md:col-span-1 order-2 md:order-1">
      <slot name="sidebar">
        <!-- Default sidebar content -->
        <div class="bg-white p-4 rounded-lg shadow mb-6">
          <h2 class="text-xl font-bold mb-4 text-blue-800">News Categories</h2>
          <ul class="space-y-2">
            <li>
              <a 
                href="/news" 
                class={`text-blue-600 ${pathname === '/news/' || pathname === '/news' ? 'font-bold' : 'hover:underline'}`}
              >
                All News
              </a>
            </li>
            <li>
              <a 
                href="/news/press-releases" 
                class={`text-blue-600 ${pathname.includes('/news/press-releases') ? 'font-bold' : 'hover:underline'}`}
              >
                Press Releases
              </a>
            </li>
            <li>
              <a 
                href="/news/research" 
                class={`text-blue-600 ${pathname.includes('/news/research') ? 'font-bold' : 'hover:underline'}`}
              >
                Research Updates
              </a>
            </li>
            <li>
              <a 
                href="/news/events" 
                class={`text-blue-600 ${pathname.includes('/news/events') ? 'font-bold' : 'hover:underline'}`}
              >
                Upcoming Events
              </a>
            </li>
          </ul>
        </div>
        
        {years.length > 0 && (
          <div class="bg-white p-4 rounded-lg shadow">
            <h2 class="text-xl font-bold mb-4 text-blue-800">Archives</h2>
            <ul class="space-y-2">
              {years.map(year => (
                <li>
                  <a 
                    href={`/news/archive/${year}`} 
                    class={`text-blue-600 ${pathname.includes(`/news/archive/${year}`) ? 'font-bold' : 'hover:underline'}`}
                  >
                    {year}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        )}
      </slot>
    </aside>
    
    <!-- Main news content area -->
    <div class="md:col-span-2 order-1 md:order-2">
      <slot />
    </div>
  </div>
</BaseLayout>