---
// src/components/labs/ContentBlock.astro
const { block, lab } = Astro.props;
const directusUrl = import.meta.env.PUBLIC_DIRECTUS_URL;
---

<div class="content-block mb-8">
  {block.block_type === 'future_directions' && (
    <div class="future-directions-block">
      <div class="p-6 bg-gray-50 rounded-r-lg">
        <h2 class="text-3xl font-bold mb-6 text-blue-800 border-b-2 border-blue-300 pb-2">
          Future Directions: {block.title}
        </h2>
        
        {block.content && (
          <div class="prose max-w-none" set:html={block.content} />
        )}
        
        {block.image && (
          <div class="mt-6">
            <img 
              src={`${directusUrl}assets/${block.image}?width=800&quality=90`} 
              alt={block.title}
              class="w-full rounded-lg shadow-md"
            />
          </div>
        )}
        
        {block.url && (
          <div class="mt-6">
            <a 
              href={block.url} 
              target="_blank" 
              rel="noopener noreferrer" 
              class="inline-flex items-center px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg font-medium text-sm transition-colors duration-200"
            >
              Learn More →
            </a>
          </div>
        )}
      </div>
    </div>
  )}

  {block.block_type === 'section_header' && (
    <div class="p-6 bg-gray-50 border-l-4 border-gray-400 rounded-r-lg">
      <h2 class="text-2xl font-bold text-gray-800">{block.title}</h2>
      {block.content && (
        <div class="prose max-w-none mt-4" set:html={block.content} />
      )}
    </div>
  )}

  {block.block_type === 'rich_text' && (
    <div class="p-6 bg-white border border-gray-200 rounded-lg shadow-sm">
      {block.title && (
        <h2 class="text-2xl font-bold mb-4 text-gray-800">{block.title}</h2>
      )}
      <div class="prose max-w-none" set:html={block.content} />
    </div>
  )}

  {block.block_type === 'highlight_section' && (
    <div class="p-6 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-lg">
      {block.title && (
        <h2 class="text-2xl font-bold mb-4 text-yellow-800">{block.title}</h2>
      )}
      <div class="prose max-w-none" set:html={block.content} />
    </div>
  )}

  {block.block_type === 'project_showcase' && (
    <div class="p-6 bg-green-50 border-l-4 border-green-500 rounded-r-lg">
      <h2 class="text-2xl font-bold mb-6 text-green-800">
        {block.title || 'Featured Project'}
      </h2>
      
      <div class="grid md:grid-cols-2 gap-6">
        {block.image && (
          <div>
            <img 
              src={`${directusUrl}assets/${block.image}?width=600&quality=90`} 
              alt={block.title}
              class="w-full rounded-lg shadow-md"
            />
          </div>
        )}
        
        <div class={block.image ? '' : 'md:col-span-2'}>
          {block.content && (
            <div class="prose max-w-none" set:html={block.content} />
          )}
          
          {block.url && (
            <div class="mt-4">
              <a 
                href={block.url} 
                target="_blank" 
                rel="noopener noreferrer" 
                class="inline-flex items-center px-4 py-2 bg-green-600 text-white hover:bg-green-700 rounded-lg font-medium text-sm transition-colors duration-200"
              >
                View Project →
              </a>
            </div>
          )}
        </div>
      </div>
    </div>
  )}

  {block.block_type === 'tool_showcase' && (
    <div class="p-6 bg-orange-50 border-l-4 border-orange-500 rounded-r-lg">
      <h2 class="text-2xl font-bold mb-6 text-orange-800">
        {block.title || 'Tool'}
      </h2>
      
      <div class="grid md:grid-cols-3 gap-6">
        {block.image && (
          <div class="md:col-span-1">
            <img 
              src={`${directusUrl}assets/${block.image}?width=400&height=300&fit=cover&quality=90`} 
              alt={block.title}
              class="w-full rounded-lg shadow-md object-cover"
              style="aspect-ratio: 4/3;"
            />
          </div>
        )}
        
        <div class={block.image ? 'md:col-span-2' : 'md:col-span-3'}>
          {block.content && (
            <div class="prose max-w-none mb-4" set:html={block.content} />
          )}
          
          {block.url && (
            <a 
              href={block.url} 
              target="_blank" 
              rel="noopener noreferrer" 
              class="inline-flex items-center px-4 py-2 bg-orange-600 text-white hover:bg-orange-700 rounded-lg font-medium text-sm transition-colors duration-200"
            >
              Access Tool →
            </a>
          )}
        </div>
      </div>
    </div>
  )}

  {/* Simple fallback for everything else */}
  {!['future_directions', 'section_header', 'rich_text', 'highlight_section', 'project_showcase', 'tool_showcase'].includes(block.block_type) && (
    <div class="other-block">
      <div class="p-6 bg-white border border-gray-200 rounded-lg shadow-sm">
        <div class="text-xs text-gray-500 mb-2">Block Type: {block.block_type}</div>
        {block.title && (
          <h2 class="text-2xl font-bold mb-4 text-gray-800">{block.title}</h2>
        )}
        {block.content && (
          <div class="prose max-w-none" set:html={block.content} />
        )}
        {block.image && (
          <div class="mt-4">
            <img 
              src={`${directusUrl}assets/${block.image}?width=600&quality=90`} 
              alt={block.title || 'Image'}
              class="w-full rounded-lg shadow-md"
            />
          </div>
        )}
        {block.url && (
          <div class="mt-4">
            <a href={block.url} target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">
              {block.url}
            </a>
          </div>
        )}
      </div>
    </div>
  )}
</div>