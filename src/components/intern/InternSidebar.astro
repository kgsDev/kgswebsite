---
// src/components/InternSidebar.astro
import { fetchCurrentInternDetails, fetchInternProjectYears } from '../../lib/api_intern';

// Get current program year and available years for navigation
const currentDetails = await fetchCurrentInternDetails();
const currentYear = currentDetails?.program_year || new Date().getFullYear();
const availableYears = await fetchInternProjectYears();

const { activeSection } = Astro.props;

// Get current path for active link highlighting
const pathname = Astro.url.pathname;
---

<aside class="lg:col-span-1">
  <!-- Current Year Navigation -->
  <div class="bg-white p-4 rounded-lg shadow mb-6">
    <h3 class="font-bold mb-4 text-blue-800">Potter Internship</h3>
    <ul class="space-y-2">
      <li>
        <a 
          href="/intern" 
          class={`baselink ${activeSection === 'about' || pathname === '/intern/' || pathname === '/intern' ? 'font-bold' : 'hover:underline'}`}
          aria-label="About the Internship Program"
        >
          About
        </a>
      </li>
      <li>
        <a 
          href={`/intern/${currentYear}`}
          class={`baselink ${activeSection === 'program' || pathname.includes(`/intern/${currentYear}`) ? 'font-bold' : 'hover:underline'}`}
          aria-label={`${currentYear} Internship Program - Eligibility and Application`}
        >
          Eligibility and Application
        </a>
      </li>
      <li>
        <a 
          href={`/intern/${currentYear}#what-to-expect`}
          class={`baselink ${activeSection === 'expect' || pathname.includes(`/intern/${currentYear}#what-to-expect`) ? 'font-bold' : 'hover:underline'}`}
          aria-label={`${currentYear} Internship Program - What to Expect`}
        >
          What to Expect
        </a>
      <li>
        <a 
          href="/intern/why"
          class={`baselink ${activeSection === 'why' || pathname.includes('/intern/why') ? 'font-bold' : 'hover:underline'}`}
          aria-label="Why Participate?">
          Why Participate?
        </a>
      </li>
      <li>
        <a 
          href="/intern/projects"
          class={`baselink ${activeSection === 'projects' || pathname.includes('/intern/projects') ? 'font-bold' : 'hover:underline'}`}
          aria-label="Past Projects - Past Internship Projects"
        >
          Past Projects
        </a>
      </li>
    </ul>
  </div>
  
   
  <!-- Contact Info -->
  <div class="bg-white p-4 rounded-lg shadow">
    <h3 class="text-xl font-bold mb-4 text-blue-800">Questions?</h3>
    <p class="text-sm text-gray-700 mb-3">
      Contact us about the Paul Edwin Potter Internship program:
    </p>
    <a 
      href="mailto:kgspotterinternship@uky.edu"
      class="baselink text-sm hover:underline"
    >
      kgspotterinternship@uky.edu
    </a>
  </div>
</aside>